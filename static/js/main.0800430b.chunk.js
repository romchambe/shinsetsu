(this.webpackJsonpshinsetsu=this.webpackJsonpshinsetsu||[]).push([[0],{121:function(e,t,n){"use strict";n.r(t);var r=n(1),a=n(0),i=n.n(a),o=n(33),c=n.n(o),s=(n(60),n(12)),l=(n(61),n(8)),u=n(5),d=i.a.createContext({active:!0,timer:0,duration:18e4,startTimer:function(){console.log("")}}),f=function(e){var t=Object(a.useContext)(d),n=t.active,i=t.timer,o=t.duration,c=Object(u.b)({from:{opacity:0},to:{opacity:1}}),f=Object(u.b)((function(){return{progress:0,config:{duration:1e3}}})),h=Object(s.a)(f,2),m=h[0].progress;(0,h[1])({progress:i/o});var b=m.interpolate({range:[0,.2,.8,1],output:["#ff9696","#ffdaa7","#ffdaa7","#b09afe"]}),j=m.interpolate({range:[0,.2,.8,1],output:["#ffe6e6","#fff6ea","#fff6ea","#efebfa"]}),p=m.interpolate((function(e){return"translate(-".concat(e*(window.innerWidth+64),"px,").concat(.3*Math.pow(2*e-1,2)*window.innerHeight,"px)")})),v={background:"linear-gradient(".concat(270-180*m.getValue(),"deg, ").concat(j.getValue(),", transparent)")};return Object(r.jsxs)(u.a.div,{className:"flex min-h-full w-full flex-col overflow-hidden",style:Object(l.a)(Object(l.a)({},v),c),children:[n?Object(r.jsx)(u.a.div,{className:"absolute rounded-2xl w-8 h-8",style:{right:-32,top:32,transform:p,backgroundColor:b}}):null,e.children]})},h=n.p+"static/media/shinsetsu-square.7dd6f5e2.png",m=n.p+"static/media/shinsetsu-text.9f84c9e4.png",b=function(e){var t="".concat(Math.floor(e.value/6e4)<10?"0":"").concat(Math.floor(e.value/6e4),":").concat(Math.floor(e.value%6e4/1e3)<10?"0":"").concat(Math.floor(e.value%6e4/1e3));return Object(r.jsx)("div",{className:"rounded-lg bg-white w-40 h-12",children:Object(r.jsx)("div",{className:"text-3xl text-center leading-none py-2 font-bold text-funky-text",children:t})})},j=function(e){var t=Object(a.useContext)(d).timer,n=Object(u.b)((function(){return{value:0}})),i=Object(s.a)(n,2),o=i[0],c=i[1],f=Object(u.b)({opacity:e.contentsLoaded?1:0}),j=o.value.interpolate((function(e){return"translate(0px, -".concat(104*e,"px)")})),p=o.value.interpolate((function(e){return 1-e})),v=o.value.interpolate((function(e){return"translate(-".concat(86*e,"px, ").concat(104*e,"px)")})),g=o.value.interpolate((function(e){return"translate(".concat(30*e,"px, 0px)")}));return e.contentScrolled&&c({value:1}),e.contentScrolled||c({value:0}),Object(r.jsxs)(u.a.div,{className:"flex flex-col w-full py-6 items-center",style:{transform:j},children:[Object(r.jsx)(u.a.img,{src:h,alt:"shinsetsu logo",style:{width:48,transform:v}}),Object(r.jsx)(u.a.img,{alt:"shinsetsu",src:m,style:{height:20,opacity:p},className:"mt-3"}),Object(r.jsx)(u.a.div,{className:"mt-6",style:Object(l.a)(Object(l.a)({},{transform:g}),f),children:Object(r.jsx)(b,{value:t})})]})},p=n(15),v=i.a.createContext({scrolling:!1,shouldReload:!1,deactivateReload:function(){console.log("")}}),g=function(e){return Object(r.jsxs)("div",{className:"block mb-4 rounded bg-white border border-yellow-border",children:[Object(r.jsx)("div",{className:"font-yogasanspro py-4 px-3  font-bold text-black",children:x(e.timestamp)}),Object(r.jsx)("img",{src:e.images.src,alt:e.description,style:{width:"28rem",height:"28rem",objectFit:"contain"}}),Object(r.jsx)("div",{className:"font-yogasanspro py-3 px-3 text-md overflow-hidden",style:{maxHeight:"8.5rem"},children:e.description})]})};function x(e){var t=Date.now(),n=1e3*e,r=new Intl.RelativeTimeFormat("fr");if(t-n<36e5){var a=Math.round((n-t)/6e4);return r.format(a,"minutes")}if(t-n<864e6){var i=Math.round((n-t)/36e5);return r.format(i,"hours")}var o=Math.round((n-t)/864e5);return r.format(o,"days")}var O=n(25),y=n.n(O),w=function(e){var t=e.posts,n=e.contentsLoaded,i=Object(a.useState)([]),o=Object(s.a)(i,2),c=o[0],d=o[1],f=Object(a.useState)([]),h=Object(s.a)(f,2),m=h[0],b=h[1],j=Object(a.useContext)(v),x=j.shouldReload,O=j.deactivateReload,w=Object(u.b)({opacity:n?1:0}),S=Object(a.useCallback)((function(e){var n=[],a=[];t.forEach((function(t,i){i<e&&!m.includes(t.id)&&(n.push(Object(r.jsx)(g,Object(l.a)({},t),t.id)),a.push(t.id))})),d([].concat(Object(p.a)(c),n)),b([].concat(Object(p.a)(m),a))}),[t]);return Object(a.useEffect)((function(){S(c.length+9),O()}),[x]),t.length>0&&0===c.length&&S(c.length+9),console.log("RENDER FEED",w),n?Object(r.jsxs)(u.a.div,{style:Object(l.a)(Object(l.a)({},{width:"28rem"}),w),children:[c.length>0?Object(r.jsx)("div",{className:"text-xl font-yogasanspro tracking-tight text-md px-1 pb-2",children:"\ud83c\udfd4 monogatari de la Montagne Enneig\xe9e"}):null,c]}):Object(r.jsxs)(u.a.div,{className:"flex flex-col items-center",style:{width:"28rem"},children:[Object(r.jsx)(y.a,{type:"Audio",color:"#9a82e6",height:32,width:32,timeout:5e3}),Object(r.jsx)("div",{className:"text-center mt-6",children:"la nuit venue, la neige fra\xeeche refl\xe9ta les astres dans un silencieux scintillement"})]})},S=n(26),T=n.n(S),C=n(52),N=n(4),k=n(9),R=n(7),E=n(6),L=n(53),A=n.n(L);function M(e){var t=H(e,"entry_data"),n=e.substring(t),r=["{"];try{for(var a=0,i=1,o=n.substring(H(n,"{")+1).split("");i>0;)"{"===o[a]&&(i+=1),"}"===o[a]&&(i-=1),i>0&&r.push(o[a]),a+=1;r.push("}")}catch(c){console.error(c)}return JSON.parse(r.join(""))}function _(e){var t=e.TagPage[0].graphql.hashtag.edge_hashtag_to_media.edges;return(t=t.map((function(e){var t=e.node,n=t.id,r=t.taken_at_timestamp,a="";try{a=t.edge_media_to_caption.edges[0].node.text}catch(i){console.error(i,t)}return{timestamp:r,images:t.thumbnail_resources.reduce((function(e,t){return e.config_width<t.config_width?t:e})),description:a,id:n}}))).sort((function(e,t){return t.timestamp-e.timestamp})),t}function H(e,t){var n=e.match(t);if(n&&n.index)return n.index;throw new Error("no data")}var D=function(e){Object(R.a)(n,e);var t=Object(E.a)(n);function n(e){var r;return Object(N.a)(this,n),(r=t.call(this,e)).state={posts:[],contentsLoaded:!1},r}return Object(k.a)(n,[{key:"componentDidMount",value:function(){var e=Object(C.a)(T.a.mark((function e(){var t,n,r;return T.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log(this.context),e.next=3,A()("https://instagram.com/explore/tags/".concat(this.props.hashtag,"/")).text();case 3:t=e.sent,n=M(t),r=_(n),this.setState({posts:r,contentsLoaded:!0}),this.context.startTimer();case 8:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){return this.props.render(this.state)}}]),n}(a.Component);D.contextType=d;var F=n(54),I=function(e){Object(R.a)(n,e);var t=Object(E.a)(n);function n(e){var r;return Object(N.a)(this,n),(r=t.call(this,e)).scrollContainer=null,r.reloadAnim=null,r.handleScroll=function(e){console.log("Scroll",e.currentTarget.scrollTop);var t=r.scrollContainer?r.scrollContainer.scrollHeight-r.scrollContainer.clientHeight:null;e.currentTarget.scrollTop>16&&r.setState((function(e){return e.scrolling?null:(r.props.setContentScrolled(!0),{scrolling:!0})})),e.currentTarget.scrollTop<=16&&r.setState((function(e){return e.scrolling?(r.props.setContentScrolled(!1),{scrolling:!1}):null})),t&&e.currentTarget.scrollTop>=t-16&&(r.setState((function(e){return e.reloadAnim?null:{reloadAnim:!0}})),r.reloadAnim||(r.reloadAnim=setTimeout((function(){r.setState((function(e){return e.shouldReload?null:{shouldReload:!0,reloadAnim:!1}})),r.reloadAnim&&clearTimeout(r.reloadAnim)}),800)))},r.state={scrolling:!1,shouldReload:!1,reloadAnim:!1,deactivateReload:function(){return r.setState({shouldReload:!1})}},r}return Object(k.a)(n,[{key:"render",value:function(){var e=this;return Object(r.jsx)(v.Provider,{value:this.state,children:Object(r.jsx)(F.Spring,{from:{transform:"translate(0px, 0px)"},to:{transform:"translate(0px, ".concat(this.state.scrolling?-104:0,"px)")},children:function(t){return Object(r.jsxs)("div",{className:"flex flex-col items-center overflow-y-auto pb-12",onScroll:e.handleScroll,ref:function(t){return e.scrollContainer=t},style:Object(l.a)(Object(l.a)({},t),{marginBottom:-104}),children:[e.props.children,e.state.reloadAnim?Object(r.jsx)("div",{className:"mt-6",children:Object(r.jsx)(y.a,{type:"Audio",color:"#9a82e6",height:32,width:32,timeout:5e3})}):null]})}})})}}]),n}(a.Component);var P=function(e){Object(R.a)(n,e);var t=Object(E.a)(n);function n(e){var r;return Object(N.a)(this,n),(r=t.call(this,e)).timer=null,r.startTimer=function(){r.timer=setInterval(r.updateTime,1e3)},r.stopTimer=function(){r.timer&&clearInterval(r.timer),r.timer=null},r.endSession=function(){var e=Date.now()+12e5;window.localStorage.setItem("sessionRestart",e.toString()),r.setState({sessionRestart:e,active:!1})},r.updateTime=function(){r.setState((function(e){return e.timer+1e3>e.duration?(r.stopTimer(),r.endSession(),{active:!1,timer:e.timer}):{active:!0,timer:e.timer+1e3}}))},r.onVisibilityChange=function(e){console.log("EVENT",e),"hidden"===document.visibilityState&&r.timer&&r.stopTimer(),"visible"!==document.visibilityState||r.timer||r.startTimer()},r.state={active:!0,timer:0,duration:3e4,startTimer:r.startTimer,sessionRestart:null},r}return Object(k.a)(n,[{key:"componentDidMount",value:function(){var e=function(){var e=null,t=null,n=document;return"undefined"!==typeof n.hidden?(e="hidden",t="visibilitychange"):"undefined"!==typeof n.msHidden?(e="msHidden",t="msvisibilitychange"):"undefined"!==typeof n.webkitHidden&&(e="webkitHidden",t="webkitvisibilitychange"),{hidden:e,visibilityChange:t}}().visibilityChange;e&&"undefined"!==typeof document.addEventListener&&document.addEventListener(e,this.onVisibilityChange)}},{key:"render",value:function(){return Object(r.jsx)(d.Provider,{value:this.state,children:this.state.active?this.props.children:Object(r.jsxs)("div",{className:"flex flex-col items-center w-full",children:[Object(r.jsx)(j,{contentScrolled:!1,contentsLoaded:!1}),Object(r.jsx)("div",{className:"mt-6",children:"dans quelques minutes, la neige fraiche aura fondu, patience... ;)"})]})})}}]),n}(a.Component),V=function(){var e=Object(a.useState)(!1),t=Object(s.a)(e,2),n=t[0],i=t[1];return Object(r.jsx)("div",{className:"h-screen w-full flex",children:Object(r.jsx)(P,{children:Object(r.jsx)(D,{hashtag:"chamonix",main:!0,render:function(e){var t=e.contentsLoaded,a=e.posts;return Object(r.jsxs)(f,{contentsLoaded:t,children:[Object(r.jsx)(j,{contentScrolled:n,contentsLoaded:t}),Object(r.jsx)(I,{setContentScrolled:i,children:Object(r.jsx)(w,{posts:a,contentsLoaded:t})})]})}})})})},q=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,122)).then((function(t){var n=t.getCLS,r=t.getFID,a=t.getFCP,i=t.getLCP,o=t.getTTFB;n(e),r(e),a(e),i(e),o(e)}))};c.a.render(Object(r.jsx)(i.a.StrictMode,{children:Object(r.jsx)(V,{})}),document.getElementById("root")),q()},60:function(e,t,n){},61:function(e,t,n){},92:function(e,t){},94:function(e,t){}},[[121,1,2]]]);
//# sourceMappingURL=main.0800430b.chunk.js.map